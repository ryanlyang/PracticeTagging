==========================================
Fresh KD Training - ATLAS Top Tagging
==========================================
Job ID: 21021079
Node: skl-a-40
Start Time: Sat Jan 17 10:14:32 AM EST 2026
==========================================

Python: /home/ryreu/miniconda3/envs/atlas_kd/bin/python
PyTorch: 2.5.1
CUDA available: True
GPU: NVIDIA A100-PCIE-40GB

Hyperparameters:
  Run Name: A_cal0_ema0_adapt0_rel0.06
  temp_init: 7.0
  temp_final: constant
  alpha_init: 0.5
  alpha_final: constant
  alpha_attn/rep/nce/rel: 0.05 / 0.10 / 0.10 / 0.06
  adaptive_alpha: 0
  calibrate_teacher: 0
  ema_teacher: 0 (decay=0.999)
  self_train: 0 (source=teacher)

Using GPU for training
Running command:
python fresh_KD.py     --save_dir checkpoints/fresh_kd_sweep     --run_name A_cal0_ema0_adapt0_rel0.06     --temp_init 7.0     --alpha_init 0.5     --alpha_attn 0.05     --alpha_rep 0.10     --alpha_nce 0.10     --alpha_rel 0.06     --tau_nce 0.10 --teacher_checkpoint checkpoints/fresh_kd/shared_models/teacher.pt --baseline_checkpoint checkpoints/fresh_kd/shared_models/baseline.pt --n_train_jets 200000 --max_constits 80 --skip_save_models --device cuda

Device: cuda
Save dir: checkpoints/fresh_kd_sweep/A_cal0_ema0_adapt0_rel0.06
KD settings:
  conf_weighted_kd=True, alpha_attn=0.05, alpha_rep=0.1, alpha_nce=0.1, alpha_rel=0.06, tau_nce=0.1
Loading data via utils.load_from_files...
Loaded: data=(200000, 80, 7), labels=(200000,)
Avg particles per jet (raw mask): 52.0
Applying HLT effects...

HLT Simulation Statistics:
  Offline particles: 10,408,553
  Lost to pT threshold (1.5): 0 (0.0%)
  Lost to merging (dR<0.01): 4,132,985 (39.7%)
  Lost to efficiency: 188,743 (1.8%)
  HLT particles: 6,086,825 (58.5% of offline)
Offline particles after 0.5 threshold: 10,408,553
Avg per jet: Offline=52.0, HLT=30.4
Computing features...
NaN check: Offline=0, HLT=0
Split sizes: Train=140000, Val=30000, Test=30000
Final NaN check: Offline=0, HLT=0
Saved test features/masks to: /home/ryreu/atlas/PracticeTagging/test_split/test_features_and_masks.npz

======================================================================
STEP 1: TEACHER (Offline / high-quality view)
======================================================================
Loading pre-trained teacher from: checkpoints/fresh_kd/shared_models/teacher.pt
Loaded teacher with AUC=0.9425

======================================================================
STEP 2: BASELINE HLT (Low-quality view, no KD)
======================================================================
Loading pre-trained baseline from: checkpoints/fresh_kd/shared_models/baseline.pt
Loaded baseline with AUC=0.8298

======================================================================
STEP 3: STUDENT with KD (HLT view + teacher guidance)
======================================================================
Ep 5: loss=13.8797, val_auc=0.8057, best=0.8057 | T=7.00, alpha_kd=0.50
Ep 10: loss=13.8044, val_auc=0.8226, best=0.8226 | T=7.00, alpha_kd=0.50
Ep 15: loss=13.7690, val_auc=0.8284, best=0.8313 | T=7.00, alpha_kd=0.50
Ep 20: loss=13.7451, val_auc=0.8310, best=0.8326 | T=7.00, alpha_kd=0.50
Ep 25: loss=13.7247, val_auc=0.8343, best=0.8343 | T=7.00, alpha_kd=0.50
Ep 30: loss=13.7049, val_auc=0.8342, best=0.8362 | T=7.00, alpha_kd=0.50
Ep 35: loss=13.6886, val_auc=0.8367, best=0.8367 | T=7.00, alpha_kd=0.50
Ep 40: loss=13.6712, val_auc=0.8361, best=0.8370 | T=7.00, alpha_kd=0.50
Ep 45: loss=13.6613, val_auc=0.8349, best=0.8370 | T=7.00, alpha_kd=0.50
Ep 50: loss=13.6586, val_auc=0.8353, best=0.8370 | T=7.00, alpha_kd=0.50
Skipped saving student model (best val AUC=0.8370)

======================================================================
FINAL TEST EVALUATION
======================================================================

==========================================
Training failed with exit code: 1
End Time: Sat Jan 17 11:04:02 AM EST 2026
==========================================
